language: rust
rust:
  - stable
  - nightly
branches:
  only:
    - master
install:
  - rustup component add clippy-preview
script:
  - cargo test
  # Run clippy on codebase
  - touch src/lib.rs  # Touch is needed to force clippy to check the code
  # Running clippy on lib and tests only as bench uses features not available on stable toolchain
  - cargo clippy --lib --tests --all-features -- -D clippy::pedantic -D clippy::nursery
notifications:
  email:
    on_success: never
